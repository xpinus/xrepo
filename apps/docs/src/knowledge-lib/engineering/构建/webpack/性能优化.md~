# æ€§èƒ½ä¼˜åŒ–

## æ„å»ºä¼˜åŒ–

> ä½ æ˜¯å¦‚ä½•ä¼˜åŒ–webpackæ„å»ºæ—¶é—´çš„ï¼Ÿå…·ä½“æ€ä¹ˆé‡åŒ–çš„ï¼Ÿ
- ä¸ºä»€ä¹ˆä¸ç”¨vite: Vite å¯ä»¥ç›´æ¥è·³è¿‡æ‰“åŒ…çš„æ­¥éª¤ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®åŸºäº webpackï¼Œä½“é‡å¾ˆå¤§ï¼Œé‡Œé¢ç”¨åˆ°äº†å¾ˆå¤š webpack ç”Ÿæ€çš„æ’ä»¶å’Œ loaderï¼Œå†’ç„¶è¿ç§»åˆ° Vite å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›æœªçŸ¥çš„é£é™©ï¼Œä¾‹å¦‚åœ¨ Vite ç”Ÿæ€ä¸­æ‰¾ä¸åˆ°å¯¹æ ‡çš„æ’ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨ Vite ä¸­é€šè¿‡è‡ªå®šä¹‰æ’ä»¶æ¥å®ç°é‚£ä¸ªæ’ä»¶çš„åŠŸèƒ½ï¼Œè¿™ä¸ªå·¥ä½œé‡æ˜¯ä¸å¯é¢„ä¼°çš„
- åœ¨ webpack ä¸­æœ‰ä¸€ä¸ªæ’ä»¶ `speed-measure-webpack-plugin`ï¼Œæˆ‘å°±æ˜¯é€šè¿‡è¿™ä¸ªæ’ä»¶å»æŸ¥çœ‹çš„æ„å»ºæ—¶é—´ï¼Œå®ƒä¼šå‡ºä¸€ä»½æŠ¥å‘Šï¼ŒåŒ…å«æ€»ä½“æ„å»ºæ—¶é—´ã€å„é˜¶æ®µçš„è€—æ—¶ã€æ’ä»¶è€—æ—¶ã€loader è€—æ—¶ï¼Œè¿™æ ·æˆ‘å°±èƒ½éå¸¸æ¸…æ¥šç©¶ç«Ÿæ˜¯å“ªäº›åœ°æ–¹è€—æ—¶ã€‚
- é€šè¿‡æ’ä»¶çš„åˆ†æç»“æœæ¥çœ‹ï¼Œæˆ‘å‘ç° Babel åœ¨ç¼–è¯‘ JS æ—¶ç‰¹åˆ«è€—æ—¶ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€äº› loaderï¼Œæ¯”å¦‚å¤„ç† CSS çš„ css-loaderï¼Œåœ¨è§£æå’Œå¤„ç†è¿‡ç¨‹ä¸­ä¹ŸæŒºè€—æ—¶çš„ã€‚å› æ­¤æˆ‘è€ƒè™‘çš„ä¸»è¦ä¼˜åŒ–æ–¹æ¡ˆæœ‰ï¼š
  - ç”¨ swc æ›¿æ¢ babel è¿›è¡Œç¼–è¯‘å·¥ä½œ
  - thread-loader è§£å†³ loader è§£æè€—æ—¶é—®é¢˜
- å¦å¤–è¿˜é…åˆäº†ä¸€äº›é¢å¤–çš„ä¼˜åŒ–æ‰‹æ®µã€‚ï¼ˆé’©å­ğŸªï¼‰æœ€ç»ˆè½åœ°çš„æ–¹æ¡ˆæ•ˆæœéå¸¸å¥½ï¼Œå†æ¬¡ç”¨ speed-measure-webpack-plugin æ’ä»¶è¿›è¡Œæ„å»ºæ—¶é—´åˆ†æï¼ŒåŸºæœ¬ä¸Šæ„å»ºæ—¶é—´åœ¨ 10 å¤šç§’å·¦å³ã€‚

> ä½ è¯´ä½ ç”¨åˆ°äº† swcï¼Œé‚£ä¹ˆå°±å…ˆè®²ä¸€è®²è¿™ä¸ªå§ï¼Œä»€ä¹ˆæ˜¯ swcï¼Œå®ƒçš„ä¼˜åŠ¿æœ‰ä»€ä¹ˆï¼Ÿä½ ä¸ºä»€ä¹ˆç”¨å®ƒæ¥æ›¿æ¢ babel ï¼Ÿ
- swc æ˜¯ä¸€ä¸ªç”¨ rust å†™çš„ JS/TS ç¼–è¯‘å™¨ï¼Œå› ä¸ºåŸºäº rustï¼Œæ‰€ä»¥ç¼–è¯‘é€Ÿåº¦éå¸¸å¿«ï¼Œè€Œä¸” swc èƒ½å¤Ÿå…¼å®¹å¤§å¤šæ•° babel æ’ä»¶å’Œé…ç½®ï¼Œå› æ­¤è¿ç§»èµ·æ¥æ²¡æœ‰å¤ªé«˜çš„æˆæœ¬ã€‚ï¼ˆåšä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼‰
- åšå¼€å§‹åšä¼˜åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬é¡¹ç›®çš„æ„å»ºæ—¶é—´å·®ä¸å¤šè¦èŠ±è´¹ 8ï½10åˆ†é’Ÿå·¦å³ï¼Œæ›¿æ¢ä¸º swc ç¼–è¯‘åï¼Œæ„å»ºæ—¶é—´å‡å°‘åˆ°äº†çº¦ 3 åˆ†é’Ÿå·¦å³ã€‚ï¼ˆä¼˜åŒ–å‰åçš„åŒºåˆ«ï¼‰
- æ‰€ä»¥æ•´ä¸ªä¼˜åŒ–æ–¹æ¡ˆä¸­ swc æ˜¯æœ€é‡è¦ï¼Œå å¤§å¤´çš„ã€‚è€Œ loader è§£æè€—æ—¶çš„é—®é¢˜ï¼Œæˆ‘æ˜¯é€šè¿‡ thread-loader æ¥è§£å†³çš„

> thread-loaderå®ƒæ˜¯å¦‚ä½•è§£å†³ loader è§£æè€—æ—¶é—®é¢˜çš„ï¼Ÿ
- thread-loader å¯ä»¥é€šè¿‡å¤šçº¿ç¨‹å¹¶è¡Œå¤„ç† loader æ“ä½œï¼Œè¿™æ ·å°±å‡å°‘äº†ä¸»çº¿ç¨‹çš„è´Ÿè½½ã€‚
- å½“æˆ‘ä»¬ç”¨äº† thread-loader ä»¥åï¼Œå¤„ç†å›¾ç‰‡ã€CSS ç›¸å…³ loader çš„è€—æ—¶é—®é¢˜ä¹Ÿå°±è§£å†³äº†ï¼Œæ„å»ºæ—¶é—´è¿›ä¸€æ­¥ç¼©å‡åˆ°äº† 2 åˆ†é’Ÿã€‚

> è¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„ä¼˜åŒ–æ‰‹æ®µ
- å‡çº§ webpack5 æ–°æä¾›çš„æŒä¹…åŒ–ç¼“å­˜æŠ€æœ¯ï¼Œèƒ½å¤ŸæŠŠæ¨¡å—çš„ç¼–è¯‘ç»“æœã€è§£æç»“æœä»¥åŠæ’ä»¶çš„æ‰§è¡Œç»“æœç¼“å­˜åˆ°å†…å­˜æˆ–è€…æ–‡ä»¶é‡Œé¢ï¼Œè¿™æ ·åç»­è¿›è¡Œæ„å»ºçš„æ—¶å€™å°±å¯ä»¥é‡ç”¨è¿™äº›ç¼“å­˜æ•°æ®ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡å¤è®¡ç®—å’Œç¼–è¯‘ã€‚å½“ç„¶ï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨é¡¹ç›®çš„æ—¶å€™ï¼Œæ—¶é—´ä¸Šé¢æ²¡æœ‰å¤ªå¤§å˜åŒ–ï¼Œå› ä¸ºç¼“å­˜è¿˜æ²¡æœ‰ç”Ÿæˆã€‚
- ç”Ÿäº§ç¯å¢ƒä¸‹å–å‡ºhash
- å‡çº§ä¸€äº›è€æ—§çš„æ’ä»¶ï¼Œå› ä¸ºä¸€äº›æ’ä»¶æ–°ç‰ˆæœ¬ç›¸è¾ƒäºæ—§ç‰ˆæœ¬ï¼Œä¼šä¿®å¤ä¸€äº› bugï¼Œåœ¨æ€§èƒ½ã€ç®—æ³•ä¸Šé¢å¯èƒ½ä¹Ÿä¼šæœ‰ä¸€äº›æå‡
  -  terser-webpack-plugin è¿™ä¸ªæ’ä»¶æ˜¯åšå‹ç¼©çš„ã€‚å› ä¸ºæ‰“åŒ…çš„æ—¶å€™æœ‰ä¸€ä¸ªé‡è¦çš„ä»»åŠ¡å°±æ˜¯è¦å‹ç¼©ï¼Œè€Œå‹ç¼©æ‰€èŠ±è´¹çš„æ—¶é—´ä¹ŸæŒºé•¿çš„ï¼Œæˆ‘å°±ç¢ç£¨ç€èƒ½ä¸èƒ½å‡å°‘ä¸€ä¸‹å‹ç¼©æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚


## è¾…åŠ©åˆ†ææ’ä»¶

é”™è¯¯æç¤ºä¼˜åŒ–ï¼š
friendly-errors-webpack-pluginï¼šæ›´å¥½çš„é”™è¯¯æç¤º
node-notifierï¼šè°ƒç”¨çš„ç³»ç»Ÿçš„å³ä¸‹è§’æç¤ºå¼¹çª—

`speed-measure-webpack-plugin`ï¼šæ‰“åŒ…æ€§èƒ½åˆ†æ, æŸ¥çœ‹æ„å»ºæ—¶é—´ï¼ŒåŒ…å«æ€»ä½“æ„å»ºæ—¶é—´ã€å„é˜¶æ®µçš„è€—æ—¶ã€æ’ä»¶è€—æ—¶ã€loader è€—æ—¶ã€‚
speed-measure-webpack5 -plugin

webpack-bundle-analyzer-pluginï¼šæ‰“åŒ…ç»“æœåˆ†æ
> genertate stats fileé…ç½®é¡¹ç”Ÿæˆæ‰“åŒ…æŠ¥å‘Š

`webpack --progress` 

webpack-optimizer-plugin

## ç¼©å°èŒƒå›´

é…ç½® , æ§åˆ¶å¼•å…¥æ–‡ä»¶æ—¶åŒ¹é…çš„èŒƒå›´
```json
resolve: {
  extensions: ['.js', '.jsx', '.ts', '.tsx', '.json'], 
}
```

## å¿½ç•¥æ¨¡æ¿

noParse: é…ç½®ï¼Œè®©ä¸€äº›æ¨¡å—è¢«å¿½ç•¥ï¼Œä¸è§£æ,

Webpack.IgnorePlugin:å¿½ç•¥æ¨¡å—ï¼Œä¸è§£æ

## ç¼“å­˜ä¸çº¿ç¨‹

```js
use: [
  {
      // å¼€å¯å¤šçº¿ç¨‹ï¼Œçº¿ç¨‹å¼€å¯ç»“æŸä¹Ÿè¦æ¶ˆè€—èµ„æºï¼Œé™¤éé¡¹ç›®çœŸçš„å¾ˆå¤§ï¼Œå¦åˆ™æ²¡ä¸è¦
    loader: "thread-loader",
    options: {
      workers: 1,  // å¼€å¯å‡ ä¸ªworkeræ¥æ‰“åŒ…
    },
  },
]

```

## å‹ç¼©

```json
optimization: {
  minimize: true,
  minimizer: [
    new TerserPlugin({
      extractComments: false,
      ...
    }),
  ],
}
```

image-minimizer-webpack-plugin

mini-css-extract-plugin

purge-css-webpack-plugin

## tree-shaking

é»˜è®¤çš„

## ä»£ç åˆ†å‰²ï¼Œæå–å…¬å…±ä»£ç 

`webpackPrefetch: true` è®©æ‡’åŠ è½½çš„ç»„ä»¶è‡ªåŠ¨æ·»åŠ ä¸Šscript prefetch

åŸºç¡€åº“
å…±ç”¨ä»£ç 

```json
optimization: {
  splitChunks: {
    chunks: 'all'// é»˜è®¤asyncåªåˆ†å‰²å¼‚æ­¥æ¨¡å—
    
  }
}
```


